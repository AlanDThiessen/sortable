!function(e,t,n){"use strict";function o(o,r,i){function a(){return r.children().length}function l(e){w=t.isString(q.dropzone)?t.element(q.dropzone):t.element("<"+e.prop("localName")+">"),w.addClass("drop-zone"),q.sameSize&&w.css({height:e.prop("clientHeight")+"px",width:e.prop("clientWidth")+"px"}),e.after(w)}function s(e,t){for(var n=0;n<t.length;n++){var o=t.eq(n),r=o.data("sortable.computedStyle");o.css({height:r.height,width:r.width})}var i=e[0].getBoundingClientRect(),a=e.data("sortable.computedStyle");e.addClass("dragging").css({height:a.height,left:i.left-a.marginLeft.slice(0,-2)+"px",pointerEvents:"none",position:"absolute",top:i.top-a.marginTop.slice(0,-2)+"px",width:a.width,zIndex:100})}function c(e){for(var t=r.children(),n=document.elementFromPoint(e.x,e.y),o=0;o<t.length;o++)if(t[o]===n||t[o].contains(n))return t[o]}function d(e){return Array.prototype.indexOf.call(r.children(),e[0])}function u(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function g(e){e.preventDefault(),e.stopPropagation(),S=t.element(e.currentTarget),C.x=e.clientX,C.y=e.clientY,document.addEventListener("mousemove",p),document.addEventListener("mouseup",h)}function p(e){e.preventDefault();var t={x:e.clientX-C.x,y:e.clientY-C.y};u(t)<q.threshold||(S.hasClass("dragging")||v(S,S.children()),m(e,S,t))}function h(e){document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",h),S.hasClass("dragging")&&f(e,S,S.children())}function f(e,n,o){var r=n.data("sortable.index"),a=d(w);a>r&&a--,y(n.removeClass("dragging"));for(var l=0;l<o.length;l++)y(o.eq(l));t.isArray(E.sequence)?(w.remove(),i.$apply(function(){E.sequence.splice(a,0,E.sequence.splice(r,1)[0])})):w.replaceWith(n),t.isFunction(E.dragEnd)&&E.dragEnd(n,a,r,E.sequence)}function m(e,n,o){n.css("transform","translate("+o.x+"px, "+o.y+"px)");var r={x:e.clientX,y:e.clientY},i=c(r);i&&i!==w[0]&&x(r,i),t.isFunction(E.dragMove)&&E.dragMove(n)}function v(e,n){b(e);for(var o=0;o<n.length;o++)b(n.eq(o));s(e,n),l(e.data("sortable.index",d(e))),t.isFunction(E.dragStart)&&E.dragStart(e)}function b(t){t.data("sortable.style",t.attr("style")||""),t.data("sortable.computedStyle")||t.data("sortable.computedStyle",e.getComputedStyle(t[0]))}function y(e){e.attr("style",e.data("sortable.style"))}function x(e,t){var n=e.y-t.getBoundingClientRect().top,o=t.clientHeight>>1;n>o?t.nextElementSibling!==w[0]&&r[0].insertBefore(w[0],t.nextElementSibling):t.previousElementSibling!==w[0]&&r[0].insertBefore(w[0],t)}var w,S,E=this,q={dropzone:n,sameSize:!0,threshold:2},C={};E.options&&t.extend(q,E.options),""===o.sortable&&(E.sortable=!0),i.$watch(a,function(e){if(e){var t=r.children();E.sortable&&t.on("mousedown",g)}}),i.$watch("sortable",function(e){var t=r.children();e?t.on("mousedown",g):t.off("mousedown",g)})}o.$inject=["$attrs","$element","$scope"],t.module("sortable",[]).directive("sortable",function(){return{controller:o,controllerAs:"$sortable",bindToController:{options:"=?",dragEnd:"=?",dragMove:"=?",dragStart:"=?",sequence:"=?ngModel",sortable:"=?"}}})}(window,angular);